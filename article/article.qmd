---
title: "MAPCLUST - СЕРВИС ДЛЯ ЭПИДЕМИОЛОГИЧЕСКОГО И ЭКОЛОГИЧЕСКОГО МОНИТОРИНГА"
author: "Смирнов Антон Сергеевич^1^,Захаров Олег Станиславович^1^,Пятницкий Алексей Михайлович^1^, Гукасов Вадим Михайлович^2^"
toc: true
toc-depth: 3
bibliography: references.bib
csl: gost2.csl
tbl-cap-location: top
toc-title: "Оглавление"
fontsize: 14pt
engine: knitr
linestretch: 1.5
geometry:
  - top=10mm
  - left=20mm
  - right=20mm
  - heightrounded
format:
  docx:
    toc: false
  pdf:
    documentclass: article
    pdf-engine: xelatex
    header-includes: |
      \usepackage[utf8]{inputenc}
      \usepackage[american,russian]{babel}
      \usepackage{hyperref}  
      \usepackage{unicode-math}
mainfont: Arial
monofont: Arial
sansfont: Arial
editor: visual
---

1 - РНИМУ им. Н.И. Пирогова, Москва, 2 - ФГБНУ НИИ РИНКЦЭ, Москва

# Аннотация

Эта статья посвящена описанию разработанного авторами веб-сервиса для кластеризации пространственных и пространственно-временных данных MapClust. MapClust является практической реализацией исследований, проведенных нами в предыдущих работах. В этой работе мы демонстрируем применение сервиса для решения задач эпидемиологического и экологического мониторинга.

Ключевые слова: MapClust; эпидемиологический мониторинг; экологический мониторинг; алгоритм кластеризации.

# Введение

Поиск кластеров в пространственных данных является нетривиальной задачей, решение которой важно для мониторинга ситуации в некоторой изучаемой области. В текущий момент, в связи с неблагоприятной эпидемиологической и экологической ситуацией в мире остро стоит задача обнаружения областей, на которые в первую очередь необходимо обратить внимание для принятия мер. Один из наиболее популярных видов методов поиска кластеров, например, в анализе эпидемиологии туберкулеза -- сканирующие статистики[@shaweno2018]. Самый известный метод сканирующей статистики -- метод Куллдорфа[@kulldorff1997]. Этот метод широко используется в современных эпидемиологических исследованиях[@odhiambo2023; @kiani2021; @ito2022]. Однако, метод зависит от формы и размера сканирующую окна, выдает один наиболее вероятный кластер и обладает довольно большой вероятностью ложноположительного результата, то есть в кластеры часто попадают области, которые не имеют никакого отношения к ним[@tango2021]. 

Для преодоления этих ограничений был разработан MapClust, новый веб-сервис для кластеризации пространственных и пространственно-временных данных. MapClust обладает рядом преимуществ по сравнению с существующими методами. Во-первых, он не зависит от формы и размера кластера, что позволяет более точно определять кластеры с различной структурой. Во-вторых, он позволяет пользователю регулировать чувствительность алгоритма, обеспечивая лучший контроль над балансом между ложноположительными и ложноотрицательными результатами. Наконец, MapClust разработан для одновременного поиска нескольких кластеров при сохранении заданной величины ошибок I рода, что позволяет получить более полное представление о данных.

Данная работа организована следующим образом: сначала мы описываем принципы работы алгоритма MapClust, включая расчеты для определения p-значений и уравнения, используемые для обнаружения и оценки кластеров. Далее мы приводим несколько примеров и приложений, демонстрирующих использование MapClust для задач эпидемиологического и экологического мониторинга. Наконец, в заключение мы суммируем ключевой вклад и выводы данного исследования, а также обсуждаем практические последствия применения метода MapClust в различных областях.

# Принцип работы

Данный сервис получает на вход данные о взаиморасположении областей исследования и о значении исследуемой величины в этой области. Критерий подразумевает, что исследуемая величина - частота события в каком-либо регионе. Данные должны быть представлены в специальном общеиспользуемом геоинформационном формате -- ESRI Shapefile. Формат Shapefile - это популярный формат геопространственных векторных данных, разработанный компанией ESRI для использования в программном обеспечении географических информационных систем (ГИС). Shapefile используются в различных приложениях, включая анализ пространственных и пространственно-временных данных, картографию и геопространственную визуализацию. В контексте веб-сервиса MapClust формат Shapefile используется для предоставления входных данных о расположении интересующих областей и связанных с ними анализируемых значений. Благодаря использованию широко распространенного геопространственного формата Shapefiles, MapClust обеспечивает совместимость с различным программным обеспечением ГИС и упрощает подготовку и интеграцию данных для пользователей.

Принцип поиска кластеров описан в статьях[@pyatnickiy2020_1; @pyatnickiy2020_2; @pyatnitskiy2021_1; @pyatnitskiy2021_2]. Для каждого региона рассчитывается значение p для сравнения величин в регионах (@eq-p-spat) или для сравнения моментов времени (@eq-p-time), где $\Phi(x)$ - функция Лапласа. Для каждой области, для которой p меньше или выше некоторого порога, заданного пользователем, рассчитываются статистики для разряжений (@eq-discharges-stat) и для кластеров (@eq-clust-stat).

$$
p = \Phi(\frac{O_i - \overline{O}}{\sqrt{\overline{O}}})
$$ {#eq-p-spat}

$$
p = \Phi(\frac{O_{i}^{t2} - O_{i}^{t1}}{\sqrt{O_{i}^{t1} + O_{i}^{t2}}})
$$ {#eq-p-time}

$$
S_n = -2\sum_{k=1}^n{ln{\frac{p_k}{p_{down}}}}
$$ {#eq-discharges-stat}

$$
S_n = -2\sum_{k=1}^n{ln{\frac{1 - p_k}{1 - p_{up}}}}
$$ {#eq-clust-stat}

Программа проверяет вхождение значения статистик в критическую область S(n), где n -- число регионов соседей, для которых p меньше или выше определенного порога. Программа строит эту область методом Монте-Карло. Кластеры или разрежения, выходящие за критическую область, являются значимыми.

# Примеры работы

Приведем несколько примеров работы. Для первого примера возьмем данные по заболеваемостью вирусом иммунодефицита человека (ВИЧ) в Российской Федерации (РФ) с портала ЕМИСС[@aleksandrova]. Веб-сервис может работать в двух режимах работы: пространственном и пространственно-временном. Пространственный режим заключается в поиске кластеров по величине, измерянной в регионах определенной местности. Пространственно-временной режим - поиск кластеров по разнице некоторой величины во времени. Для начала работы необходимо построить критическую область. Для этого необходимо загрузить все файлы из архива, выбрать количество итераций и задать пороговые значения $p_{down}$ и $p_{up}$. Если $p_{down}=0$ или $p_{up}=1$, программа соответственно будет искать разряжения или кластеры. Для примера возьмем $p_{down}=0.1$, $p_{up}=0.85$ и $\alpha=0.05$ и запустим критерий для в первом режиме для данных 2005 года и в втором режиме для данных 2005 и 2006 года. Результаты представлены на @fig-first. Программа также позволяет получить список областей, составляющих кластеры или разряжения. Из полученных данных можно сделать выводы о регионах с благополучной и тревожной эпидемиологической обстановкой. Например, на @fig-second продемонстрированы регионы с неблагоприятной эпидемиологической обстановкой (кластеры). Нетрудно заметить, что обнаружено несколько кластеров неправильной формы и разного размера.

![Критическая область для обнаруженных кластеров и разряжений](result_1.png){#fig-first}

![Карта расположения статистически значимых кластеров. Границы кластеров обозначены черными линиями](result_2.png){#fig-second}

Также в практическом плане может быть гораздо полезнее смотреть динамику распространения инфекции. Наша программа позволяет сравнивать показатели. Сравним с теми же параметрами 2005 и 2006 год. Результат представлен на @fig-third. Статистически значимое улучшение обстановки за год наблюдается только в Санкт-Петербурге.

![Сравнение количества новых случаев заражения ВИЧ-инфекцией в РФ в 2005 и в 2006 годах.](result_3.png){#fig-third}

В качестве задачи экологического мониторинга рассмотрим поиск очагов ухудшения качества воздуха в Румынии. Данные взяты с сайта Европейского агентства по окружающей среде[@annuala]. В качестве показателя, отображающего качество воздуха, возьмем концентрацию частиц диаметром меньше или равного 10 микрометрам (PM10). Рассмотрим, как изменилось качество воздуха с 2018 по 2021 год. Запустим критерий с параметрами $p_{down}=0.2$, $p_{up}=0.8$ и $\alpha=0.05$. Результат представлен на @fig-fourth. Наблюдается статистически значимое улучшение качества воздуха в районе Плоешти и Брашова, который исторически был промышленным в Румынии.

![Сравнение PM10 в Румынии за 2018 и 2021 год.](result_4.png){#fig-fourth}



# Заключение

В этой работе был представлен веб-сервис MapClust, новый инструмент для эффективной кластеризации и анализа пространственных и пространственно-временных данных, специально разработанный для задач эпидемиологического, экологического и других видов мониторинга. Ключевым вкладом и результат работы являются разработка алгоритма, который преодолевает ограничения существующих методов, таких как статистика сканирования Куллдорфа, не зависящих от формы и размера кластера, предлагающих регулируемую чувствительность и возможность поиска нескольких кластеров при контроле величины ошибок первого типа.

На приведенных примерах мы продемонстрировали эффективность MapClust при выявлении регионов с различной эпидемиологической ситуацией, касающейся распространенности ВИЧ в Российской Федерации и мониторинга качества воздуха в Румынии. Эти практические приложения демонстрируют потенциальные преимущества использования MapClust в здравоохранении и управлении окружающей средой. Позволяя более точно определять области, требующие вмешательства, MapClust может помочь лицам, принимающим решения, более эффективно распределять ресурсы, что в конечном итоге приведет к улучшению состояния здоровья населения и охране окружающей среды.

Разработанный сервис доступен по адресу https://epidemmonitor.ru/MapClust/ . Кроме этого, код сервиса для локального использования по адресу https://github.com/SmirnygaTotoshka/MapClust . Подробная инструкция и тестовые данные представлены на сайте. Ограничения для онлайн-использования - 100 Мб. В дальнейших планах у авторов разработать пакет для языка программирования R и распространить используемый подход на другие типы данных.

# MAPCLUST IS SERVICE FOR EPIDEMIOLOGICAL AND ECOLOGICAL MONITORING

**Smirnov Anton Sergeevich^1^, Zakharov Oleg Stanislavovich^1^, Pyatnitskiy Alexey Mikhailovich^1^, Gukasov Vadim Mikhailovich^2^,**

1 - PRNRMU, Moscow,

2 - FRCEC, Moscow

# Abstract

This article is the MapClust description. The MapClust is web-service for clusterisation of spatial and spatio-temporal data and it is authors previous research practical realisation. We demostrate web-service work on epidemiological and ecological monitoring tasks.

Keywords: MapClust; epidemiological monitoring; ecological monitoring; clustering algorithm.

# Информация об авторах

-   Смирнов Антон Сергеевич -- студент 6 курса направления «Медицинская кибернетика» МБФ РНИМУ, Москва.

-   Захаров Олег Станиславович -- студент 2 курса направления «Медицинская кибернетика» МБФ РНИМУ, Москва.

-   Пятницкий Алексей Михайлович -- доцент кафедры высшей математики МБФ РНИМУ, кандидат физико-математических наук, Москва.

-   Гукасов Вадим Михайлович -- доктор биологических наук, главный научный сотрудник Государственного центра экспертизы в сфере науки и инноваций, ФГБНУ НИИ Республиканский исследовательский научно-консультационный центр экспертизы (ФГБНУ НИИ РИНКЦЭ) Министерства науки и высшего образования России, Москва

# Контактное лицо

Смирнов Антон Сергеевич, +79109522086, e-mail: anton.smirnov.9910\@gmail.com

# Список литературы
